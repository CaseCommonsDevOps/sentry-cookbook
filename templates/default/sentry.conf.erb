# This sentry config generated by <%= node['fqdn'] %>

# <%= node['sentry']['config'] %>

<% if node['sentry']['include_settings'] %>
<%= node['sentry']['include_settings'] %> import *
<% end %>

DATABASES = {
  <% for @name, @settings in node['sentry']['databases'] %>
  "<%= @name %>": {
       <% for @key, @value in @settings %>
       "<%= @key.upcase %>": "<%= @value %>",
       <% end %>
  },
  <% end %>
}

# No trailing slash!
SENTRY_URL_PREFIX = "<%= node['sentry']['prefix'] %>"

# Set this to false to require authentication
SENTRY_PUBLIC = <%= node['sentry']['public'] %>

# SENTRY_KEY is a unique randomly generated secret key for your server, and it
# acts as a signing token

SENTRY_KEY = "<%= node['sentry']['key'] %>"

SENTRY_WEB_HOST = "<%= node['sentry']['web']['host'] %>"
SENTRY_WEB_PORT = "<%= node['sentry']['web']['port'] %>"
SENTRY_WEB_OPTIONS = {
   <% for @name, @value in node['sentry']['web']['options'] %>
   '<%= @name %>': '<%= @value %>',
   <% end %>
}


# Mail server configuration

# For more information check Django's documentation:
#  https://docs.djangoproject.com/en/1.3/topics/email/?from=olddocs#e-mail-backends

EMAIL_BACKEND = "<%= node['sentry']['email']['backend'] %>"

EMAIL_HOST = "<%= node['sentry']['email']['host'] %>"
EMAIL_HOST_PASSWORD = "<%= node['sentry']['email']['password'] %>"
EMAIL_HOST_USER = "<%= node['sentry']['email']['user'] %>"
EMAIL_PORT = "<%= node['sentry']['email']['port'] %>"
EMAIL_USE_TLS = <%= node['sentry']['email']['use_tls'] %>


<% for @network, @params in node['sentry']['social'] %>
   <% for @param, @value in @params %>
<%= @network.upcase %>_<%= @param.upcase %> = '<%= @value %>'
   <% end %>

<% end %>


SOCIAL_AUTH_CREATE_USERS = "<%= node['sentry']['social_auth_create_users'] %>"

# Custom settings

<% for @key, @value in node['sentry']['custom_settings'] %>
<%= @key.upcase %> = "<%= @value %>"
<% end %>

EXTRA_INSTALLED_APPS = [
<% for @item in node["sentry"]["plugins"] %>
   '<%= @item %>',
<% end %>
<% for @item in node["sentry"]["3_party_plugins"] %>
   <% if @item['name'] %>
   '<%= @item %>',
   <% end %>
<% end %>
]